-- create boa tables
drop table if exists SYM_ADM_TBL cascade;
CREATE TABLE SYM_ADM_TBL (
	ADM_ID bigint GENERATED BY DEFAULT AS IDENTITY(START WITH 1 INCREMENT BY 1) NOT NULL,
	ADM_NM varchar(50) NOT NULL,
	ADM_EMAIL varchar(200) NOT NULL,
	ADM_PHONE varchar(50) DEFAULT NULL NULL,
	ADM_PASSWD varchar(64) NOT NULL,
	ADM_STS smallint NOT NULL,
	ADM_CREATE_AT timestamp(3) DEFAULT now() NOT NULL,
	ADM_UPD_AT timestamp(3) DEFAULT NULL NULL,
	ADM_PASSWD_EXP_AT timestamp(3) DEFAULT NULL NULL,
	ADM_LOGIN_FAIL_CT int DEFAULT 0 NOT NULL,
	ADM_CUST_1 varchar(255) DEFAULT NULL NULL,
	ADM_CUST_2 varchar(255) DEFAULT NULL NULL,
	ADM_CUST_3 varchar(255) DEFAULT NULL NULL,
	ADM_CUST_4 varchar(255) DEFAULT NULL NULL,
	CONSTRAINT ADMNM_UNIQUE UNIQUE (ADM_NM),
	CONSTRAINT PK_SYM_ADM_TBL PRIMARY KEY (ADM_ID)
);

drop table if exists SYM_GRP_TBL cascade;
CREATE TABLE SYM_GRP_TBL (
	GRP_ID bigint GENERATED BY DEFAULT AS IDENTITY(START WITH 1 INCREMENT BY 1) NOT NULL,
	GRP_NM varchar(100) NOT NULL,
	GRP_DESC varchar(255) DEFAULT NULL NULL,
	GRP_CREATE_AT timestamp(3) DEFAULT now() NOT NULL,
	GRP_UPD_AT timestamp(3) DEFAULT NULL NULL,
	CONSTRAINT GRPNM_UNIQUE UNIQUE (GRP_NM),
	CONSTRAINT PK_SYM_GRP_TBL PRIMARY KEY (GRP_ID)
);

drop table if exists SYM_ADM_GRP_MAP_TBL cascade;
CREATE TABLE SYM_ADM_GRP_MAP_TBL (
	GRP_ID bigint NOT NULL,
	ADM_ID bigint NOT NULL,
	CONSTRAINT PK_SYM_ADM_GRP_MAP_TBL PRIMARY KEY (GRP_ID,ADM_ID),
	CONSTRAINT FK_SYM_ADM_GRP_MAP_ADM_ID FOREIGN KEY (GRP_ID) REFERENCES SYM_GRP_TBL(GRP_ID) ON DELETE cascade,
	CONSTRAINT FK_SYM_ADM_GRP_MAP_GRP_ID FOREIGN KEY (ADM_ID) REFERENCES SYM_ADM_TBL(ADM_ID) ON DELETE cascade
);

drop table if exists SYM_GRP_ROLE_TBL cascade;
CREATE TABLE SYM_GRP_ROLE_TBL (
	GRP_ID bigint NOT NULL,
	MOD_ID smallint NOT NULL,
	MOD_PERM varchar(255) NOT NULL,
	CONSTRAINT PK_SYM_GRP_ROLE_TBL PRIMARY KEY (GRP_ID,MOD_ID),
	CONSTRAINT FK_SYM_GRP_ROLE_GRP_ID FOREIGN KEY (GRP_ID) REFERENCES SYM_GRP_TBL(GRP_ID) ON DELETE cascade
);

drop table if exists SYM_ADM_LOG_TBL cascade;
CREATE TABLE SYM_ADM_LOG_TBL (
	LOG_ID bigint GENERATED BY DEFAULT AS IDENTITY(START WITH 1 INCREMENT BY 1) NOT NULL,
	ADM_ID bigint NOT NULL,
	ADM_NM varchar(50) NOT NULL,
	OBJ_ID varchar(100) NOT NULL,
	MOD_ID smallint NOT NULL,
	ACT_COD smallint NOT NULL,
	ACT_RESULT smallint NOT NULL,
	LOG_DTL varchar(4000) DEFAULT NULL NULL,
	LOG_IP_ADR varchar(45) NOT NULL,
	LOG_CREATE_AT timestamp(3) DEFAULT now() NOT NULL,
	CONSTRAINT PK_SYM_ADM_LOG_TBL PRIMARY KEY (LOG_ID)
);
 CREATE INDEX INDEX_SYM_SYM_ADM_LOG_TBL_ADM_ID ON SYM_ADM_LOG_TBL (  ADM_ID ASC  )   ;
 CREATE INDEX INDEX_SYM_SYM_ADM_LOG_TBL_MOD_ACT ON SYM_ADM_LOG_TBL (  MOD_ID ASC  , ACT_COD ASC  )   ;
 CREATE INDEX INDEX_SYM_SYM_ADM_LOG_TBL_OBJ_ID ON SYM_ADM_LOG_TBL (  OBJ_ID ASC  )   ;

drop table if exists SYM_CHK_QUE_TBL cascade;
CREATE TABLE SYM_CHK_QUE_TBL (
	MAK_ID bigint GENERATED BY DEFAULT AS IDENTITY(START WITH 1 INCREMENT BY 1) NOT NULL,
	MAK_REF varchar(40) NOT NULL,
	BRN varchar(3) DEFAULT NULL NULL,
	MAK_ADM_ID bigint NOT NULL,
	MAK_ADM_NM varchar(50) NOT NULL,
	OBJ_ID varchar(100) NOT NULL,
	MAK_STS smallint NOT NULL,
	MOD_ID smallint NOT NULL,
	MOD_ACT smallint NOT NULL,
	MAK_DESC varchar(500) DEFAULT NULL NULL,
	MAK_DESC_DAT bytea NOT NULL,
	MAK_META bytea NOT NULL,
	MAK_CREATE_AT timestamp(3) DEFAULT now() NOT NULL,
	CONSTRAINT MAKREF_UNIQUE UNIQUE (MAK_REF),
	CONSTRAINT PK_SYM_CHK_QUE_TBL PRIMARY KEY (MAK_ID)
);
 CREATE INDEX IDX_SYM_CHK_QUE_TBL_MOD_ACT ON SYM_CHK_QUE_TBL (  MOD_ID ASC  , MOD_ACT ASC  , OBJ_ID ASC  )   ;
 
 drop table if exists SYM_MAK_CHK_ARC_TBL cascade;
 CREATE TABLE SYM_MAK_CHK_ARC_TBL (
	ARC_ID bigint GENERATED BY DEFAULT AS IDENTITY(START WITH 1 INCREMENT BY 1) NOT NULL,
	MAK_REF varchar(40) NOT NULL,
	BRN varchar(3) DEFAULT NULL NULL,
	MAK_ADM_ID bigint NOT NULL,
	MAK_ADM_NM varchar(50) NOT NULL,
	OBJ_ID varchar(100) NOT NULL,
	MOD_ID smallint NOT NULL,
	MOD_ACT smallint NOT NULL,
	MAK_DESC varchar(500) DEFAULT NULL NULL,
	MAK_DESC_DAT bytea NOT NULL,
	CHK_ADM_ID bigint NOT NULL,
	CHK_ADM_NM varchar(50) NOT NULL,
	CHK_ACT smallint NOT NULL,
	MAK_CREATE_AT timestamp(3) NOT NULL,
	CHK_HND_AT timestamp(3) DEFAULT now() NOT NULL,
	CONSTRAINT PK_SYM_MAK_CHK_ARC_TBL PRIMARY KEY (ARC_ID)
);
 CREATE INDEX IDX_SYM_MAK_CHK_ARC_TBL_MOD_ACT ON SYM_MAK_CHK_ARC_TBL (  MOD_ID ASC  , MOD_ACT ASC  , OBJ_ID ASC  )   ;
 

-- init boa tables
INSERT into SYM_ADM_TBL (ADM_NM, ADM_EMAIL, ADM_PASSWD, ADM_STS, ADM_LOGIN_FAIL_CT) values ('root', 'root@boa.com', '07313f0e320f22cbfa35cfc220508eb3ff457c7e', 1, 0);
INSERT into SYM_GRP_TBL (GRP_NM, GRP_DESC) values ('root', 'root');
INSERT into SYM_ADM_GRP_MAP_TBL (ADM_ID, GRP_ID) values (1, 1);

INSERT into SYM_GRP_ROLE_TBL (GRP_ID, MOD_ID, MOD_PERM) values (1, 100, '1,2,3,4,5');
INSERT into SYM_GRP_ROLE_TBL (GRP_ID, MOD_ID, MOD_PERM) values (1, 101, '1,2,3,4,6,7');
INSERT into SYM_GRP_ROLE_TBL (GRP_ID, MOD_ID, MOD_PERM) values (1, 102, '1,2,3,4,99');
INSERT into SYM_GRP_ROLE_TBL (GRP_ID, MOD_ID, MOD_PERM) values (1, 103, '1,2,3,4');
INSERT into SYM_GRP_ROLE_TBL (GRP_ID, MOD_ID, MOD_PERM) values (1, 104, '1,2,4,99');
INSERT into SYM_GRP_ROLE_TBL (GRP_ID, MOD_ID, MOD_PERM) values (1, 105, '1,2');
INSERT into SYM_GRP_ROLE_TBL (GRP_ID, MOD_ID, MOD_PERM) values (1, 109, '1,10');
INSERT into SYM_GRP_ROLE_TBL (GRP_ID, MOD_ID, MOD_PERM) values (1, 110, '1,2,17,18');
--ECFPS
-- nm
INSERT into SYM_GRP_ROLE_TBL (GRP_ID, MOD_ID, MOD_PERM) values (1, 107, '1,2,3,4,11,12,19,99');
-- domestic payment
INSERT into SYM_GRP_ROLE_TBL (GRP_ID, MOD_ID, MOD_PERM) values (1, 201, '1,8,9,21,22,23,24,25,26,27,28,29,47,99');
-- addr
INSERT into SYM_GRP_ROLE_TBL (GRP_ID, MOD_ID, MOD_PERM) values (1, 301, '1,8,9,31,32,33');
-- addr - HKID
INSERT into SYM_GRP_ROLE_TBL (GRP_ID, MOD_ID, MOD_PERM) values (1, 303, '1,8,9,31,32,33');
-- EDDA
INSERT into SYM_GRP_ROLE_TBL (GRP_ID, MOD_ID, MOD_PERM) values (1, 401, '1,9,35,36,37,38,39,40,99');

INSERT into SYM_GRP_ROLE_TBL (GRP_ID, MOD_ID, MOD_PERM) values (1, 501, '1,42,43');
INSERT into SYM_GRP_ROLE_TBL (GRP_ID, MOD_ID, MOD_PERM) values (1, 202, '1,44,45');
INSERT into SYM_GRP_ROLE_TBL (GRP_ID, MOD_ID, MOD_PERM) values (1, 601, '1,3');
INSERT into SYM_GRP_ROLE_TBL (GRP_ID, MOD_ID, MOD_PERM) values (1, 701, '1,2,3');
-- for branch control only
INSERT INTO SYM_GRP_ROLE_TBL (GRP_ID, MOD_ID, MOD_PERM) VALUES (1, 998, '999');